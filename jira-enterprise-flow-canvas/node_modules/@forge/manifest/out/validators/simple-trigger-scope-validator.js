"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.validateTriggerScopes = void 0;
const tslib_1 = require("tslib");
const product_trigger_scopes_validator_1 = require("./product-trigger-scopes-validator");
const EVENT_SCOPE_MAPPING = tslib_1.__importStar(require("../mapping/product-event-to-scope-mapping.json"));
async function validateTriggerScopes(event, scopes) {
    const { requiredScopes, missingScopes } = await (0, product_trigger_scopes_validator_1.validateEventScopes)(event, scopes, EVENT_SCOPE_MAPPING);
    const hasRequirements = requiredScopes.current.length > 0;
    return {
        valid: missingScopes.length === 0,
        event,
        missingScopes,
        requiredScopes: hasRequirements ? requiredScopes : null
    };
}
exports.validateTriggerScopes = validateTriggerScopes;
