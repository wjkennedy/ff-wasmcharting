"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.validateGraphConnectorAuthProvider = void 0;
const text_1 = require("../../../text");
const utils_1 = require("../../../utils");
const validateGraphConnectorAuthProvider = (modules, providers, yamlContentByLine) => {
    const validationErrors = [];
    const graphConnectors = modules['graph:connector'];
    if (!graphConnectors || graphConnectors.length === 0) {
        return validationErrors;
    }
    const validAuthProviderKeys = providers?.auth?.map((authProvider) => authProvider.key) ?? [];
    graphConnectors.forEach((connector) => {
        const authProvider = connector.auth?.provider;
        if (authProvider && !validAuthProviderKeys.includes(authProvider)) {
            validationErrors.push({
                message: text_1.errors.modules.graphConnector.invalidAuthProvider(connector.key, authProvider),
                reference: text_1.References.Modules,
                level: 'error',
                ...(0, utils_1.findPosition)(connector.key, yamlContentByLine)
            });
        }
    });
    return validationErrors;
};
exports.validateGraphConnectorAuthProvider = validateGraphConnectorAuthProvider;
