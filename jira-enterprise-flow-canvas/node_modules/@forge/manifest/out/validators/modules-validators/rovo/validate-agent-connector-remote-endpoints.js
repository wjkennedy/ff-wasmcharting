"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.validateAgentConnectorRemoteEndpoints = void 0;
const types_1 = require("../../../types");
const text_1 = require("../../../text");
const utils_1 = require("../../../utils");
const validateAgentConnectorRemoteEndpoints = (allModules, yamlContentByLine) => {
    const validationErrors = [];
    const agentConnectors = allModules[types_1.AllModuleTypes.RovoAgentConnector];
    const endpointModuleKey = (0, utils_1.cleanKey)(types_1.AllModuleTypes.CoreEndpoint);
    const endpointModules = allModules[endpointModuleKey] ?? [];
    agentConnectors?.forEach((agentConnector) => {
        const a2aProtocol = agentConnector.protocols.agent2Agent;
        const endpointReference = a2aProtocol.jsonRpcTransport?.endpoint;
        const agentKey = agentConnector.key;
        const endpointModule = endpointModules.find((e) => e.key === endpointReference);
        if (!endpointModule) {
            validationErrors.push({
                message: text_1.errors.modules.rovo.incorrectA2AEndpointReference(agentKey, endpointReference),
                reference: text_1.References.Modules,
                level: 'error',
                ...(0, utils_1.findPosition)(agentKey, yamlContentByLine)
            });
        }
        if (endpointModule && !endpointModule?.remote) {
            validationErrors.push({
                message: text_1.errors.modules.rovo.incorrectA2AEndpointConfiguration(agentKey, endpointReference),
                reference: text_1.References.Modules,
                level: 'error',
                ...(0, utils_1.findPosition)(endpointReference, yamlContentByLine)
            });
        }
    });
    return validationErrors;
};
exports.validateAgentConnectorRemoteEndpoints = validateAgentConnectorRemoteEndpoints;
