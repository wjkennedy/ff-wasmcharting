"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getMetadata = void 0;
const index_1 = require("../invoke/index");
const errors_1 = require("../errors");
const utils_1 = require("./utils");
const bridge_1 = require("../bridge");
const callBridge = (0, bridge_1.getCallBridge)();
const getMetadata = async ({ functionKey, keys }) => {
    await (0, utils_1.checkRestrictedEnvironment)();
    void callBridge('trackObjectStoreAction', { action: 'getMetadata' });
    if (!functionKey || functionKey.length === 0) {
        throw new errors_1.BridgeAPIError('functionKey is required to filter and generate object metadata');
    }
    if (!Array.isArray(keys) || keys.length === 0) {
        throw new errors_1.BridgeAPIError('keys array is required and must not be empty');
    }
    const results = await Promise.all(keys.map(async (key) => {
        const result = (await (0, index_1.invoke)(functionKey, { key }));
        if (!result || typeof result !== 'object') {
            return {
                key: key,
                error: 'Invalid response from functionKey'
            };
        }
        return result;
    }));
    return results;
};
exports.getMetadata = getMetadata;
