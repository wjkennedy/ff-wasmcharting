import { optimizeLabelStack, stringifyLabelStackFully } from '../common/utils';
export function optimizeHoldInfo(holdInfo, interactionStart, reactUFOVersion) {
  const holdInfoMap = holdInfo.reduce((result, hold) => {
    const {
      labelStack,
      name,
      start,
      end,
      ignoreOnSubmit
    } = hold;
    if (labelStack && !ignoreOnSubmit && start >= interactionStart) {
      const label = stringifyLabelStackFully([...labelStack, {
        name
      }]);
      const startTime = Math.round(start);
      const endTime = Math.round(end);
      const timing = result.get(label) || {
        labelStack: optimizeLabelStack([...labelStack, {
          name
        }], reactUFOVersion),
        startTime,
        endTime
      };
      if (startTime < timing.startTime) {
        timing.startTime = startTime;
      }
      if (endTime > timing.endTime) {
        timing.endTime = endTime;
      }
      result.set(label, timing);
    }
    return result;
  }, new Map());
  return [...holdInfoMap.values()];
}