"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports._markInterfaces = void 0;
exports.pmMarksCodeGen = pmMarksCodeGen;
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _camelCase = _interopRequireDefault(require("lodash/camelCase"));
var _codeGenHelpers = require("./codeGenHelpers");
var _adfToPmAutogeneratedMessage = require("./adfToPmAutogeneratedMessage");
var _objectToSortedArray = require("./objectToSortedArray");
var _markInterfaces = exports._markInterfaces = function _markInterfaces(markName, markType, markTypeDefinitionName, markAttrs) {
  var markAttrsName = "".concat(markName, "Attributes");
  if (markAttrs) {
    return [(0, _codeGenHelpers._interface)(markAttrsName, (0, _codeGenHelpers.buildADFAttributesTypes)(markAttrs).join(';')), (0, _codeGenHelpers._interface)(markTypeDefinitionName, "type: \"".concat(markType, "\", attrs: ").concat(markAttrsName)), (0, _codeGenHelpers._interface)("".concat(markName, " extends Mark"), "attrs: ".concat(markAttrsName))].join('\n\n');
  }
  return [(0, _codeGenHelpers._interface)(markTypeDefinitionName, "type: \"".concat(markType, "\"")), (0, _codeGenHelpers._type)(markName, 'Mark')].join('\n\n');
};
function pmMarksCodeGen(markResMap) {
  return (0, _codeGenHelpers._codeBlock)(_adfToPmAutogeneratedMessage.adfToPmAutogeneratedMessage, (0, _codeGenHelpers._namedImport)('../../schema/createPMSpecFactory', 'createPMMarkSpecFactory'), (0, _codeGenHelpers._namedTypeImport)('@atlaskit/editor-prosemirror/model', 'Mark'), (0, _objectToSortedArray.objectToSortedArray)(markResMap).map(function (_ref) {
    var _ref2 = (0, _slicedToArray2.default)(_ref, 2),
      key = _ref2[0],
      _ref2$ = _ref2[1],
      mark = _ref2$.mark,
      pmMarkSpec = _ref2$.pmMarkSpec;
    var functionName = (0, _camelCase.default)(key);
    var markName = (0, _codeGenHelpers.convertTypeToTypeName)(key, 'Mark');
    var markTypeDefinitionName = (0, _codeGenHelpers.convertTypeToTypeName)(key, 'Definition');
    var markAttrs = mark.getSpec().attrs;
    return (0, _codeGenHelpers._codeBlock)(
    // build mark types
    _markInterfaces(markName, mark.getType(), markTypeDefinitionName, markAttrs),
    // build markSpec
    (0, _codeGenHelpers._functionCallToVariable)(functionName, "createPMMarkSpecFactory".concat(markAttrs ? "<".concat(markName, ">") : ''), [(0, _codeGenHelpers.stringifyWithUndefined)(pmMarkSpec)]));
  }).join('\n\n'));
}