"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.buildRequired = buildRequired;
exports.buildVariantRequired = buildVariantRequired;
exports.hasRequiredAttributes = hasRequiredAttributes;
var _isAnyOf = require("../../utils/isAnyOf");
function buildRequired(attrs, hasContent, name) {
  var required = ['type'];
  if (hasRequiredAttributes(attrs)) {
    required.push('attrs');
  }
  if (hasContent) {
    required.push('content');
  }

  // Version exists only on doc
  if (name === 'doc') {
    required.unshift('version');
  }
  return required;
}
function hasRequiredAttributes(attrs) {
  var required = false;
  if (attrs) {
    if ((0, _isAnyOf.isAnyOf)(attrs)) {
      attrs.anyOf.forEach(function (attrsSet) {
        Object.values(attrsSet).forEach(function (value) {
          // If we have a single required attribute, we need the attrs field
          if (!value.optional) {
            required = true;
          }
        });
      });
    } else {
      Object.values(attrs).forEach(function (value) {
        // If we have a single required attribute, we need the attrs field
        if (!value.optional) {
          required = true;
        }
      });
    }
  }
  return required;
}
function buildVariantRequired(content) {
  var _content$, _content$2, _content$3;
  if (typeof ((_content$ = content[0]) === null || _content$ === void 0 ? void 0 : _content$.minItems) === 'number' && ((_content$2 = content[0]) === null || _content$2 === void 0 ? void 0 : _content$2.minItems) >= 1 || Boolean((_content$3 = content[0]) === null || _content$3 === void 0 || (_content$3 = _content$3.range) === null || _content$3 === void 0 ? void 0 : _content$3.type)) {
    return {
      required: ['content']
    };
  }
  return {};
}