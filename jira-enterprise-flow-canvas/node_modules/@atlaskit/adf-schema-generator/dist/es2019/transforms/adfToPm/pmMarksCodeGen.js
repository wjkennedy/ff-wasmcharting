import camelCase from 'lodash/camelCase';
import { _codeBlock, _namedImport, _namedTypeImport, _interface, buildADFAttributesTypes, _functionCallToVariable, _type, convertTypeToTypeName, stringifyWithUndefined } from './codeGenHelpers';
import { adfToPmAutogeneratedMessage } from './adfToPmAutogeneratedMessage';
import { objectToSortedArray } from './objectToSortedArray';
export const _markInterfaces = (markName, markType, markTypeDefinitionName, markAttrs) => {
  const markAttrsName = `${markName}Attributes`;
  if (markAttrs) {
    return [_interface(markAttrsName, buildADFAttributesTypes(markAttrs).join(';')), _interface(markTypeDefinitionName, `type: "${markType}", attrs: ${markAttrsName}`), _interface(`${markName} extends Mark`, `attrs: ${markAttrsName}`)].join('\n\n');
  }
  return [_interface(markTypeDefinitionName, `type: "${markType}"`), _type(markName, 'Mark')].join('\n\n');
};
export function pmMarksCodeGen(markResMap) {
  return _codeBlock(adfToPmAutogeneratedMessage, _namedImport('../../schema/createPMSpecFactory', 'createPMMarkSpecFactory'), _namedTypeImport('@atlaskit/editor-prosemirror/model', 'Mark'), objectToSortedArray(markResMap).map(([key, {
    mark,
    pmMarkSpec
  }]) => {
    const functionName = camelCase(key);
    const markName = convertTypeToTypeName(key, 'Mark');
    const markTypeDefinitionName = convertTypeToTypeName(key, 'Definition');
    const markAttrs = mark.getSpec().attrs;
    return _codeBlock(
    // build mark types
    _markInterfaces(markName, mark.getType(), markTypeDefinitionName, markAttrs),
    // build markSpec
    _functionCallToVariable(functionName, `createPMMarkSpecFactory${markAttrs ? `<${markName}>` : ''}`, [stringifyWithUndefined(pmMarkSpec)]));
  }).join('\n\n'));
}