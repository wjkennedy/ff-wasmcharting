import _slicedToArray from "@babel/runtime/helpers/slicedToArray";
import { useContext, useEffect, useState } from 'react';
import { getGlobalTheme, ThemeMutationObserver } from '@atlaskit/tokens';
import { ThemeContext } from '../context/theme';

/**
 * __useTheme()__
 *
 * Returns the current theme settings when inside the app provider.
 */
export function useTheme() {
  var theme = useContext(ThemeContext);
  var _useState = useState(theme || getGlobalTheme()),
    _useState2 = _slicedToArray(_useState, 2),
    resolvedTheme = _useState2[0],
    setResolvedTheme = _useState2[1];
  useEffect(function () {
    // We are using theme from context so no need to reference the DOM
    if (theme) {
      return;
    }
    var observer = new ThemeMutationObserver(setResolvedTheme);
    observer.observe();
    return function () {
      return observer.disconnect();
    };
  }, [theme]);
  return theme ? theme : resolvedTheme;
}